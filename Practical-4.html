<!DOCTYPE html>
<html>
<head>
<title>Dynamic JavaScript Shop (ES6 + API)</title>

<style>
*{box-sizing:border-box;font-family:Arial;}
body{margin:0;background:#f7fff6;}
header{background:#4CAF50;color:white;text-align:center;padding:15px;}
nav{background:#111;color:white;text-align:center;padding:10px;}
.container{width:90%;margin:auto;}
#search{width:60%;padding:8px;border-radius:5px;margin:15px 0;}
.products{
    display:grid;
    grid-template-columns:repeat(auto-fit,minmax(250px,1fr));
    gap:15px;
}
.card{
    background:white;
    padding:10px;
    border-radius:10px;
    border:2px solid #ccc;
    text-align:center;
    box-shadow:0 0 8px rgba(0,0,0,.2);
}
.card img{width:100%;height:180px;object-fit:contain;}
button{
    background:#4CAF50;
    color:white;border:none;
    padding:8px 12px;border-radius:6px;
    cursor:pointer;
}
button:hover{background:darkgreen;}
#status{
    margin-top:10px;
    padding:10px;
    border:2px dashed orange;
    background:#fff6c1;
}
footer{margin-top:15px;text-align:center;background:#111;color:white;padding:10px;}
</style>
</head>

<body>

<header>
    <h1>SmartMart Dynamic Shop</h1>
    <p>Powered by Modern JavaScript</p>
</header>

<nav>
    Cart Items: <span id="cartCount">0</span>
</nav>

<div class="container">

<input type="text" id="search" placeholder="Search product...">

<p id="status">Loading products...</p>

<div class="products" id="productContainer"></div>

</div>

<footer>Â© 2025 SmartMart Dynamic Shop</footer>


<script>
// ------------------ ES6 DATA (Local Array + Objects) ------------------
let cart = 0;

let localProducts = [
    {id:1, title:"Apples", price:120, image:"https://via.placeholder.com/200", category:"fruit"},
    {id:2, title:"Milk", price:55, image:"https://via.placeholder.com/200", category:"dairy"},
    {id:3, title:"Rice", price:80, image:"https://via.placeholder.com/200", category:"grain"}
];

// ------------------ RENDER FUNCTION (Reusable) ------------------
const renderProducts = (products = []) => {
    const container = document.getElementById("productContainer");
    container.innerHTML = "";

    if(products.length === 0){
        container.innerHTML = "<h3>No products found.</h3>";
        return;
    }

    products.forEach(({id, title, price, image}) => {
        const card = document.createElement("div");
        card.className = "card";
        card.innerHTML = `
            <img src="${image}">
            <h3>${title}</h3>
            <p>â‚¹${price}</p>
            <button onclick="addToCart('${title}', ${price})">Add to Cart</button>
        `;
        container.appendChild(card);
    });
};

// ------------------ ADD TO CART FUNCTION (DOM + Logic) ------------------
const addToCart = (item, price) => {
    cart++;
    document.getElementById("cartCount").innerHTML = cart;

    document.getElementById("status").innerHTML =
        cart >= 3 
        ? "ðŸŽ‰ Offer Activated! You added 3+ items!"
        : `Added ${item} (â‚¹${price}) to cart`;
};

// ------------------ FETCH PRODUCTS FROM API (Async + Await) ------------------
const loadProducts = async () => {
    try{
        document.getElementById("status").innerHTML = "Fetching products from API...";

        const response = await fetch("https://fakestoreapi.com/products");
        const data = await response.json();

        // Convert API products to our format using map + spread
        const apiProducts = data.map(p => ({
            id:p.id,
            title:p.title,
            price:p.price,
            image:p.image,
            category:p.category
        }));

        allProducts = [...localProducts, ...apiProducts]; // merge arrays
        renderProducts(allProducts);

        document.getElementById("status").innerHTML = "Products Loaded Successfully!";
    }
    catch(error){
        document.getElementById("status").innerHTML =
            "API Failed! Showing local product list instead.";
        renderProducts(localProducts);
    }
};

let allProducts = [];
loadProducts();

// ------------------ SEARCH / FILTER (Event Handling) ------------------
document.getElementById("search").addEventListener("input", e => {
    const keyword = e.target.value.toLowerCase();

    const filtered = allProducts.filter(p =>
        p.title.toLowerCase().includes(keyword)
    );

    renderProducts(filtered);
});
</script>

</body>
</html>